# 2.7 字符串操作

## 目标

- 掌握 PHP 字符串的创建、插值、转义与多字节处理。
- 熟悉常用字符串函数及其语法、参数与返回值。
- 能在处理 UTF-8、JSON、URL、模板时避免编码错误。
- 理解字符串安全处理和转义的重要性。

## 章节内容

本章分为两个独立小节，每节提供详细的概念解释、语法说明、参数列表和完整示例：

1. **[字符串创建方式](section-01-string-creation.md)**：单引号、双引号、Heredoc、Nowdoc 的语法、特点、变量插值、转义序列及选择建议。

2. **[常用字符串函数](section-02-string-functions.md)**：长度计算（`strlen`、`mb_strlen`）、查找定位（`strpos`、`mb_strpos`）、截取（`substr`、`mb_substr`）、替换（`str_replace`）、去除空白（`trim`）、大小写转换、分割拼接、格式化等函数的详细用法。

## 字符串创建方式

| 形式     | 示例                         | 特性 / 说明                  |
| :------- | :--------------------------- | :--------------------------- |
| 单引号   | `'Hello\n'`                  | 不解析转义，`\'`、`\\` 例外 |
| 双引号   | `"Hello\n{$name}"`          | 支持转义与变量插值          |
| Heredoc  | `<<<TEXT ... TEXT;`         | 类似双引号，可插值          |
| Nowdoc   | `<<<'TEXT' ... TEXT;`       | 类似单引号，不解析变量      |

## 多字节字符串处理

处理 UTF-8 等多字节字符时，必须使用 `mb_*` 系列函数：

- `mb_internal_encoding('UTF-8')`：设置内部编码
- `mb_strlen($str)`：字符长度
- `mb_substr($str, $start, $length)`：截取子串
- `mb_strpos($haystack, $needle)`：查找位置

## 字符串安全

- **HTML 转义**：`htmlspecialchars($str, ENT_QUOTES, 'UTF-8')`
- **SQL 注入防护**：使用 PDO 预处理语句，不要使用 `addslashes()`
- **正则转义**：`preg_quote($pattern)`

## 学习建议

1. **按顺序学习**：先理解字符串创建方式，再学习字符串函数。

2. **重点掌握**：
   - 单引号和双引号的区别
   - 变量插值的正确使用
   - 多字节字符串处理
   - 常用字符串函数的参数和返回值

3. **实践练习**：
   - 完成每小节后的练习题目
   - 实现实际的字符串处理功能
   - 处理多语言文本

4. **注意安全**：
   - 始终对用户输入进行转义
   - 使用正确的编码处理多字节字符
   - 避免 SQL 注入和 XSS 攻击

## 完成本章后

- 能够正确使用四种字符串创建方式。
- 掌握常用字符串函数的语法和用法。
- 能够正确处理 UTF-8 多字节字符。
- 理解字符串安全处理的重要性。
- 能够实现常见的字符串处理功能。

## 相关章节

- **2.4 数据类型**：了解字符串类型的基本特性。
- **2.6 表达式与运算符**：了解字符串连接运算符。
- **2.8 数组**：了解字符串与数组的转换。
