# 5.15.4 自定义验证规则

## 概述

自定义验证规则能够满足特定业务需求。本节介绍如何编写自定义验证规则，包括规则设计、规则实现、规则注册等，帮助零基础学员实现灵活的验证系统。

**章节类型**：实践性章节

**主要内容**：
- 自定义规则概述
- 规则编写
- 规则注册
- 规则复用
- 规则测试
- 完整示例

## 核心内容

### 自定义规则概述

- 为什么需要自定义规则
- 规则设计原则
- 规则接口

### 规则编写

- 规则类设计
- 验证逻辑实现
- 错误消息定义
- 参数支持

### 规则注册

- 规则注册方法
- 规则命名
- 规则发现
- 规则加载

### 规则复用

- 规则封装
- 规则组合
- 规则库
- 规则共享

## 基本用法

### 自定义规则示例

```php
<?php
declare(strict_types=1);

class PhoneNumberRule implements RuleInterface {
    public function validate($value): bool {
        return preg_match('/^1[3-9]\d{9}$/', $value);
    }
    
    public function getMessage(): string {
        return '手机号格式不正确';
    }
}
```

## 使用场景

- 业务特定验证
- 复杂验证逻辑
- 可复用验证
- 验证库扩展

## 注意事项

- 规则设计
- 错误消息
- 性能考虑
- 规则测试

## 常见问题

- 如何编写自定义规则？
- 如何注册规则？
- 如何测试规则？
- 如何复用规则？

## 最佳实践

- 遵循规则接口
- 提供清晰的错误消息
- 编写规则测试
- 创建规则库
