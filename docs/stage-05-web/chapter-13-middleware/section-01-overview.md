# 5.13.1 中间件概述

## 概述

中间件是处理请求和响应的可重用组件。本节介绍中间件的概念、作用、中间件链等基础知识，帮助零基础学员理解中间件机制。

**章节类型**：概念性章节

**主要内容**：
- 中间件概念
- 中间件的作用
- 中间件链
- 执行顺序
- 请求处理流程
- 响应处理流程
- 完整示例

## 核心内容

### 中间件概念

- 什么是中间件
- 中间件的特点
- 中间件的优势

### 中间件的作用

- 请求预处理
- 响应后处理
- 功能增强
- 横切关注点

### 中间件链

- 链式执行
- 执行顺序
- 请求传递
- 响应传递

### 执行流程

- 请求阶段
- 响应阶段
- 双向处理
- 流程控制

## 基本用法

### 中间件示例

```php
<?php
declare(strict_types=1);

function middleware($request, $next) {
    // 请求前处理
    $request = processRequest($request);
    
    // 调用下一个中间件
    $response = $next($request);
    
    // 响应后处理
    $response = processResponse($response);
    
    return $response;
}
```

## 使用场景

- 认证授权
- 日志记录
- 错误处理
- 请求验证
- 响应格式化

## 注意事项

- 执行顺序
- 请求修改
- 响应修改
- 异常处理

## 常见问题

- 什么是中间件？
- 中间件如何执行？
- 如何控制执行顺序？
- 中间件的优势？

## 最佳实践

- 单一职责原则
- 保持中间件简单
- 注意执行顺序
- 实现可配置的中间件
