# 5.16.4 错误响应格式

## 概述

统一的错误响应格式能够提高 API 的可用性。本节介绍错误响应格式的设计原则、错误码规范等，帮助零基础学员设计合理的错误响应格式。

**章节类型**：最佳实践章节

**主要内容**：
- 错误响应设计
- 统一格式规范
- 错误码规范
- 错误消息设计
- 错误详情控制
- 完整示例

## 核心内容

### 错误响应设计

- 响应结构设计
- 必需字段
- 可选字段
- 格式一致性

### 统一格式

- JSON 格式
- 字段命名
- 字段类型
- 格式规范

### 错误码规范

- 错误码设计
- 错误码分类
- 错误码文档
- 错误码映射

### 错误消息

- 用户友好消息
- 技术错误消息
- 消息国际化
- 消息模板

## 基本用法

### 错误响应格式示例

```php
<?php
declare(strict_types=1);

$errorResponse = [
    'error' => [
        'code' => 'VALIDATION_ERROR',
        'message' => '输入验证失败',
        'details' => [
            'email' => 'Email 格式不正确'
        ]
    ]
];

http_response_code(400);
header('Content-Type: application/json');
echo json_encode($errorResponse);
```

## 使用场景

- API 错误响应
- 统一错误格式
- 错误文档
- 客户端处理

## 注意事项

- 格式一致性
- 错误码规范
- 消息清晰
- 安全性考虑

## 常见问题

- 如何设计错误响应格式？
- 如何定义错误码？
- 如何提供错误消息？
- 如何保持格式一致性？

## 最佳实践

- 设计统一的错误格式
- 使用标准错误码
- 提供清晰的错误消息
- 区分用户和技术错误
