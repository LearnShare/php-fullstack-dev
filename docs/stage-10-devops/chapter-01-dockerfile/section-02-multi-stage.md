# 10.1.2 多阶段构建

## 概述

多阶段构建是优化 Docker 镜像大小的重要方法。本节介绍多阶段构建的概念、实现方法、优化技巧，帮助零基础学员理解如何使用多阶段构建。

**章节类型**：实践性章节

**主要内容**：
- 多阶段构建概述
- 构建方法
- 优化技巧
- 完整示例

## 核心内容

### 多阶段构建概述

- 多阶段构建的作用
- 构建原理
- 优势特点

### 构建方法

- 多个 FROM 指令
- 阶段命名
- 阶段间复制
- 最终镜像

### 优化技巧

- 选择基础镜像
- 最小化最终镜像
- 分离构建和运行
- 优化复制操作

## 基本用法

### 多阶段构建示例

```dockerfile
# 多阶段构建示例
```

## 完整示例

### 示例：PHP 应用多阶段构建

```dockerfile
# 完整示例代码
```

## 注意事项

- 合理划分阶段
- 最小化最终镜像
- 优化构建过程
- 注意阶段依赖

## 常见问题

### Q: 多阶段构建有什么优势？

A: 可以减小最终镜像大小，分离构建环境和运行环境，提高安全性。

### Q: 如何选择多阶段构建的时机？

A: 当需要编译或构建工具，但运行时不需要这些工具时使用多阶段构建。

## 最佳实践

- 合理划分阶段
- 最小化最终镜像
- 优化构建过程
- 注意阶段依赖

## 对比分析

### 单阶段 vs 多阶段构建

- 镜像大小对比
- 构建时间对比
- 适用场景对比

## 实践任务

1. 实现多阶段构建
2. 优化镜像大小
3. 测试构建效果
