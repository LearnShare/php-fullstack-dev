# 7.6.3 聚合根（Aggregate Root）

## 概述

聚合是 DDD 中一致性边界的概念。本节介绍聚合和聚合根的概念、设计方法、边界确定等，帮助零基础学员掌握聚合设计。

**章节类型**：概念性章节

**主要内容**：
- 聚合概念
- 聚合根概念
- 聚合边界
- 聚合设计原则
- 聚合一致性
- 完整示例

## 核心内容

### 聚合概念

- 什么是聚合
- 聚合的作用
- 一致性边界

### 聚合根

- 什么是聚合根
- 聚合根的作用
- 聚合根设计
- 聚合根访问

### 聚合边界

- 边界确定
- 边界原则
- 边界大小
- 边界设计

### 聚合设计

- 聚合设计原则
- 聚合大小
- 聚合关系
- 聚合事务

## 基本用法

### 聚合设计示例

```php
<?php
declare(strict_types=1);

// 聚合根
class Order {
    private array $items = [];
    
    public function addItem(OrderItem $item): void {
        $this->items[] = $item;
        $this->recalculateTotal();
    }
    
    private function recalculateTotal(): void {
        // 维护聚合一致性
    }
}

// 聚合内的实体
class OrderItem {
    // 只能通过聚合根访问
}
```

## 使用场景

- 复杂业务对象
- 一致性要求
- 事务边界
- 业务规则

## 注意事项

- 聚合大小
- 边界设计
- 一致性保证
- 性能考虑

## 常见问题

- 什么是聚合？
- 如何设计聚合？
- 聚合边界如何确定？
- 如何保证聚合一致性？

## 最佳实践

- 设计小聚合
- 明确聚合边界
- 通过聚合根访问
- 保证聚合一致性
