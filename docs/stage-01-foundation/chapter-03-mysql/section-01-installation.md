# 1.3.1 MySQL 安装与配置

## 概述

MySQL 是最流行的关系型数据库之一。本节介绍 MySQL 8.0+ 的安装和配置方法，包括 Docker 方式（推荐）和本地安装方式。让零基础学员能够成功运行 MySQL，并理解每一步在做什么。

**章节类型**：配置性章节

**主要内容**：
- 版本与发行版选择
- Docker 方式安装（推荐）
- 本地安装（Windows、macOS、Linux）
- 基本配置（字符集、存储引擎）
- 创建第一个数据库
- 连接安全配置
- 数据目录与备份
- 常见问题排查

## 特性

- **跨平台支持**：Windows、macOS、Linux 均有完善的安装方案
- **Docker 支持**：推荐使用 Docker 方式，简单快速
- **配置灵活**：支持多种配置方式和参数
- **安全可靠**：提供完善的权限和安全配置

## 配置步骤/语法

### 版本与发行版

**推荐版本**：
- **MySQL Community 8.0**：默认选项，提供 InnoDB、GTID 复制
- **Percona Server / MariaDB**：仅在明确需求时使用
- 建议统一 `utf8mb4` 字符集、`InnoDB` 存储引擎

### Docker 方式（推荐）

**基本安装**：
- 使用 `docker run` 命令启动 MySQL 容器
- 配置环境变量（密码、数据库、用户）
- 配置端口映射和数据卷

**完整配置**：
- 使用 docker-compose 配置
- 配置自定义配置文件
- 配置数据持久化

**docker-compose 示例**：
- 完整的 docker-compose.yml 配置
- 环境变量配置
- 数据卷配置

### 本地安装

**Windows**：
- 下载 MySQL 安装器
- 运行安装向导
- 启动 MySQL 服务

**macOS**：
- 使用 Homebrew 安装
- 启动 MySQL 服务
- 配置环境变量

**Linux**：
- Debian/Ubuntu：使用 apt 安装
- CentOS/RHEL：使用 yum 安装
- 启动和配置服务

### 基本配置

**字符集配置**：
- 设置默认字符集为 `utf8mb4`
- 配置排序规则
- 配置文件位置和修改方法

**存储引擎配置**：
- 设置默认存储引擎为 `InnoDB`
- 存储引擎的特点和选择

**第一个数据库**：
- 创建数据库命令
- 创建用户和授权
- 连接测试

### 连接安全

**用户管理**：
- 创建用户
- 设置密码
- 授权管理

**安全配置**：
- 远程连接配置
- 防火墙配置
- SSL 连接配置

### 数据目录与备份

**数据目录**：
- 数据目录位置
- 日志文件位置
- 配置文件位置

**备份方法**：
- 使用 mysqldump 备份
- 备份脚本示例
- 恢复方法

## 注意事项

- **密码安全**：设置强密码，不要使用默认密码
- **数据持久化**：使用 Docker 时注意数据卷配置
- **字符集**：统一使用 `utf8mb4`，避免中文乱码
- **权限管理**：不要使用 root 用户连接应用，创建专用用户
- **备份策略**：定期备份数据库，测试恢复流程

## 常见问题

### 问题 1：无法连接到 MySQL
- **原因**：服务未启动、端口被占用、防火墙阻止
- **解决**：检查服务状态、端口占用、防火墙配置

### 问题 2：字符集乱码
- **原因**：字符集配置不正确
- **解决**：检查数据库、表、连接的字符集配置

### 问题 3：权限不足
- **原因**：用户权限配置不正确
- **解决**：检查用户权限，重新授权

### 问题 4：Docker 容器数据丢失
- **原因**：未配置数据卷
- **解决**：配置数据卷，确保数据持久化

## 输出结果说明

**安装验证示例**：
```bash
$ mysql --version
mysql  Ver 8.0.35 for Linux on x86_64
```

**连接测试示例**：
```bash
$ mysql -u root -p
Enter password: 
Welcome to the MySQL monitor.
```

## 最佳实践

- 使用 Docker 方式安装，便于环境管理
- 统一使用 `utf8mb4` 字符集和 `InnoDB` 存储引擎
- 创建专用数据库用户，不要使用 root
- 配置定期备份策略
- 记录安装和配置步骤，便于环境复现
