# 5.8 文件系统操作

## 目标

- 掌握文件读写、操作等基础文件操作
- 理解文件指针、二进制处理、文件锁等高级操作
- 熟悉目录操作和文件信息获取
- 掌握流式操作和流包装器的使用
- 了解大文件处理的方法
- 理解文件权限的管理

## 章节内容

本章分为十一个独立小节，按逻辑分组，每节提供详细的概念解释、语法说明、参数列表和完整示例：

### 第一部分：基础文件操作（5.8.1 - 5.8.3）

1. **[文件读取](section-01-file-reading.md)**：文件读取方法选择、`file_get_contents()`、`fopen()`/`fread()`、`fgets()`、`fgetc()`、`fgetcsv()`、`readfile()` 及完整示例。

2. **[文件写入](section-02-file-writing.md)**：文件写入方法选择、`file_put_contents()`、`fwrite()`、`fputcsv()` 及完整示例。

3. **[文件操作](section-03-file-operations.md)**：文件复制（`copy()`）、重命名/移动（`rename()`）、删除（`unlink()`）及完整示例。

### 第二部分：高级文件操作（5.8.4 - 5.8.6）

4. **[文件指针操作](section-04-file-pointer.md)**：文件指针概念、`ftell()`、`fseek()`、`rewind()`、`feof()` 及实际应用（随机访问、断点续传等）。

5. **[二进制文件处理](section-05-binary-files.md)**：二进制文件读写、文本模式 vs 二进制模式、二进制文件处理最佳实践。

6. **[文件锁和临时文件](section-06-file-locks-temp.md)**：文件锁（`flock()`）、临时文件（`tmpfile()`、`tempnam()`）、系统临时目录（`sys_get_temp_dir()`）及完整示例。

### 第三部分：目录和文件信息（5.8.7 - 5.8.8）

7. **[目录操作](section-07-directory-operations.md)**：目录创建（`mkdir()`）、目录删除（`rmdir()`）、目录遍历（`scandir()`、`opendir()`/`readdir()`）、路径处理函数（`realpath()`、`dirname()`、`basename()`、`pathinfo()`）及完整示例。

8. **[文件信息](section-08-file-info.md)**：文件存在性检查（`file_exists()`、`is_file()`、`is_dir()`）、文件大小（`filesize()`）、时间戳（`filemtime()`、`filectime()`、`fileatime()`）、权限检查（`is_readable()`、`is_writable()`、`is_executable()`）、详细信息（`stat()`）及完整示例。

### 第四部分：流式操作（5.8.9 - 5.8.10）

9. **[流式操作与流包装器](section-09-streaming.md)**：流的概念、流包装器（`file://`、`php://`、`http://`、`ftp://`、`data://`、`zip://` 等）、流上下文（Stream Context）、流过滤器及实际应用。

10. **[大文件处理](section-10-large-files.md)**：大文件读取、大文件写入、大文件上传、大文件下载、内存优化、完整示例。

### 第五部分：系统管理（5.8.11）

11. **[文件权限详解](section-11-file-permissions.md)**：文件权限概念、权限表示方法、`chmod()`、`chown()`、`chgrp()`、`umask()`、特殊权限位（SUID、SGID、粘滞位）及最佳实践。

## 路径与常量

- `__DIR__`：当前文件所在目录。
- `dirname(__DIR__)`：向上一级。
- `DIRECTORY_SEPARATOR`：平台相关分隔符（Windows 为 `\`，类 Unix 为 `/`）。
- `realpath($path)`：获取绝对路径。

## 学习建议

1. **按顺序学习**：按照章节顺序学习，先掌握文件读取和写入，再学习文件操作、文件指针、二进制文件处理，然后学习文件锁和临时文件，接着学习文件信息和目录操作，最后学习流式操作、大文件处理和文件权限。

2. **重点掌握**：
   - 文件读写的基本方法和适用场景
   - 文件指针的操作和应用（随机访问、断点续传等）
   - 二进制文件的正确处理方式
   - 流式操作处理大文件
   - 流包装器的使用（访问远程资源、内存流等）
   - 文件锁的使用和临时文件的处理
   - 文件信息的获取和权限管理
   - 文件权限的设置和最佳实践
   - 目录遍历和递归操作

3. **实践练习**：
   - 完成每小节后的练习题目
   - 实现实际的文件处理功能
   - 处理目录结构和文件组织
   - 实现带文件锁的日志系统

## 完成本章后

- 能够进行基本的文件读写操作。
- 理解不同文件操作方法的适用场景。
- 掌握文件指针的操作，实现随机访问和断点续传。
- 正确处理二进制文件，避免数据损坏。
- 使用流包装器访问各种资源（本地文件、远程文件、内存流等）。
- 掌握文件锁的使用，防止并发冲突。
- 能够使用临时文件处理数据。
- 掌握文件信息的获取和权限管理。
- 理解文件权限的概念和设置方法。
- 掌握目录的创建、删除和遍历。
- 能够处理大文件和目录结构。

## 相关章节

- **2.11 超级全局变量**：了解 `$_FILES` 的处理。
- **6.1.5 路径安全**：了解路径安全防护措施。
