# 2.2.2 格式化占位符详解

## 概述

格式化占位符是 `printf` 和 `sprintf` 的核心功能，用于生成格式化的字符串。本节详细介绍格式化占位符的语法、类型、参数位置指定及实际应用场景。

**章节类型**：语法性章节

**主要内容**：
- 格式化占位符的基本语法
- 常用占位符类型（`%s`、`%d`、`%f`、`%x` 等）
- 参数位置指定（`%1$s`、`%2$d`）
- 宽度和精度控制
- 实际应用场景
- 完整示例

## 特性

- **类型丰富**：支持字符串、整数、浮点数、十六进制等多种类型
- **参数位置**：可以指定参数位置，重复使用参数
- **宽度控制**：可以控制输出宽度
- **精度控制**：可以控制浮点数精度

## 语法/定义

### 基本语法

**格式**：`%[参数位置$][标志][宽度][.精度]类型`

**示例**：
- `%s`：字符串
- `%d`：整数
- `%f`：浮点数
- `%x`：十六进制（小写）
- `%X`：十六进制（大写）

### 常用占位符

| 占位符 | 类型 | 说明 |
| :----- | :--- | :--- |
| `%s` | string | 字符串 |
| `%d` | int | 整数（十进制） |
| `%f` | float | 浮点数 |
| `%x` | int | 十六进制（小写） |
| `%X` | int | 十六进制（大写） |
| `%o` | int | 八进制 |
| `%b` | int | 二进制 |
| `%c` | int | 字符（ASCII 码） |

### 参数位置指定

**语法**：`%1$s`、`%2$d`
**作用**：指定使用第几个参数
**示例**：`sprintf("%2$s %1$s", "World", "Hello")` 输出 "Hello World"

### 宽度和精度

**宽度**：`%10s`（右对齐）、`%-10s`（左对齐）
**精度**：`%.2f`（保留两位小数）

## 基本用法

### 基础示例

```php
<?php
declare(strict_types=1);

// 字符串
sprintf("Hello, %s!", "World");

// 整数
sprintf("Number: %d", 42);

// 浮点数
sprintf("Price: %.2f", 99.99);

// 十六进制
sprintf("Hex: %x", 255);
```

### 参数位置示例

```php
<?php
declare(strict_types=1);

// 重复使用参数
sprintf("%2$s %1$s", "World", "Hello");  // "Hello World"

// 指定顺序
sprintf("%1$s %1$s", "Hello");  // "Hello Hello"
```

### 宽度和精度示例

```php
<?php
declare(strict_types=1);

// 宽度控制
sprintf("%10s", "Hello");  // "     Hello"

// 精度控制
sprintf("%.2f", 99.999);  // "99.99"
```

## 使用场景

- **日志格式**：生成格式化的日志消息
- **订单号**：生成格式化的订单号
- **表格输出**：对齐的表格输出
- **数据格式化**：格式化数值、日期等

## 注意事项

- **类型匹配**：占位符类型必须与参数类型匹配
- **参数数量**：参数数量必须足够
- **精度问题**：浮点数精度可能不准确

## 常见问题

### 问题 1：参数数量不足
- **原因**：占位符数量多于参数数量
- **解决**：检查参数数量

### 问题 2：类型不匹配
- **原因**：占位符类型与参数类型不匹配
- **解决**：使用正确的占位符类型

## 最佳实践

- 使用 `sprintf` 生成格式化字符串
- 使用参数位置指定提高可读性
- 使用宽度和精度控制输出格式
- 理解各种占位符类型的用法
