# 2.13.3.1 PHPStan 配置与使用

## 概述

PHPStan 是 PHP 的静态分析工具。本节详细介绍 PHPStan 的安装、配置、使用、分析级别、规则配置、IDE 集成等。

**章节类型**：工具性章节

**主要内容**：
- PHPStan 的安装
- 配置文件（phpstan.neon）
- 分析级别的选择
- 规则配置
- IDE 集成
- CI/CD 集成
- 使用技巧和最佳实践

## 特性

- **多级别分析**：支持 0-9 级分析
- **规则丰富**：提供大量分析规则
- **IDE 支持**：支持主流 IDE
- **性能优秀**：分析速度快

## 基本用法/命令

### 安装

```bash
composer require --dev phpstan/phpstan
```

### 初始化配置

```bash
vendor/bin/phpstan init
```

### 运行分析

```bash
vendor/bin/phpstan analyse
```

### 指定级别

```bash
vendor/bin/phpstan analyse --level=5
```

## 使用场景

- **代码质量检查**：检查代码质量问题
- **类型错误检测**：发现类型相关错误
- **代码审查**：作为代码审查工具

## 注意事项

- **级别选择**：根据项目选择合适的级别
- **配置优化**：根据项目调整配置
- **性能考虑**：大型项目使用缓存

## 常见问题

### 问题 1：误报过多
- **原因**：分析级别过高
- **解决**：降低级别或添加注释

### 问题 2：分析速度慢
- **原因**：项目过大
- **解决**：使用缓存、增量分析

## 最佳实践

- 从低级别开始，逐步提高
- 使用缓存提高性能
- 集成到 CI/CD 流程
- 定期运行分析
