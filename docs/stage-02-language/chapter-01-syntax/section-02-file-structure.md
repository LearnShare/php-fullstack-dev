# 2.1.2 文件结构与编码

## 概述

PHP 文件的结构和编码是编写规范代码的基础。本节介绍 PHP 起始标签、字符编码（UTF-8）、严格类型声明、命名空间基础等文件结构规范，帮助建立良好的代码基础。

**章节类型**：配置性章节

**主要内容**：
- PHP 起始标签的类型和选择
- UTF-8 无 BOM 编码的重要性
- 严格类型声明的使用
- 命名空间基础（简要介绍）
- 文件结构最佳实践
- 常见编码问题和解决方案

## 特性

- **标准标签**：`<?php` 是推荐使用的起始标签
- **UTF-8 编码**：支持所有字符，是 Web 标准
- **严格类型**：`declare(strict_types=1);` 启用严格类型检查
- **无 BOM**：避免输出问题

## 配置步骤/语法

### PHP 起始标签

| 标签类型 | 语法 | 说明 | 推荐度 |
| :------- | :--- | :--- | :------ |
| 标准标签 | `<?php` | 推荐使用，所有环境支持 | 推荐 |
| 短标签 | `<?` | 需要 `short_open_tag=On`，不推荐 | 不推荐 |
| 短输出标签 | `<?=` | 等同于 `<?php echo`，PHP 5.4+ 始终可用 | 可用 |
| ASP 风格 | `<%` | 已废弃，不应使用 | 废弃 |

### 字符编码

**UTF-8 无 BOM 编码**：
- 为什么使用 UTF-8：支持所有字符，是 Web 标准
- 为什么无 BOM：BOM 会导致输出问题

**检查文件编码**：
- VS Code 检查方法
- 命令行检查方法
- Windows PowerShell 检查方法

### 严格类型声明

**语法**：`declare(strict_types=1);`
**位置**：文件的第一行，在 `<?php` 之后
**作用**：启用严格类型检查

### 命名空间基础

**简要介绍**：
- 命名空间的作用
- 命名空间的定义语法
- 详细内容将在阶段三学习

### 文件结构模板

**标准文件结构**：
```php
<?php
declare(strict_types=1);

namespace App\Example;

// 代码内容
```

## 注意事项

- **永远使用 `<?php`**：确保代码在所有环境中都能正常运行
- **使用 UTF-8 无 BOM**：避免编码问题
- **启用严格类型**：提高代码质量
- **文件结构规范**：为后续模块化打下基础

## 常见问题

### 问题 1：BOM 导致的问题
- **原因**：文件开头有 BOM
- **症状**：`Cannot modify header information - headers already sent`
- **解决**：使用 UTF-8 无 BOM 编码

### 问题 2：编码不一致
- **原因**：文件编码和输出编码不一致
- **解决**：统一使用 UTF-8 编码

### 问题 3：短标签不可用
- **原因**：服务器未启用 `short_open_tag`
- **解决**：使用标准标签 `<?php`

## 最佳实践

- 永远使用 `<?php` 标准标签
- 使用 UTF-8 无 BOM 编码
- 在文件开头启用严格类型
- 使用命名空间组织代码（将在阶段三学习）
- 建立标准的文件结构模板
