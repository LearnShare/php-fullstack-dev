# 2.1.4 文件执行方式

## 概述

PHP 程序可以通过不同的方式执行，每种方式有不同的执行环境和特点。本节介绍 CLI 模式、Web 模式、执行环境差异，帮助理解不同执行方式的区别和适用场景。

**章节类型**：概念性章节

**主要内容**：
- CLI 模式的特点和使用
- Web 模式的特点和使用
- 两种模式的执行环境差异
- 检测当前执行模式
- 选择适合的执行方式

## 核心内容

### CLI 模式（命令行）

**特点**：
- 直接执行 PHP 脚本
- 输出到终端
- 适合脚本、迁移、队列任务
- 单次执行，脚本结束后进程退出

**使用方式**：
- `php script.php`：执行脚本
- `php -r "code"`：执行单行代码
- `php -S localhost:8000`：启动内置服务器

### Web 模式

**特点**：
- 通过 Web 服务器执行
- 输出到浏览器
- 适合 Web 应用
- 每次请求独立执行

**使用方式**：
- 通过浏览器访问 PHP 文件
- 需要 Web 服务器（Apache、Nginx、PHP-FPM）

### 执行环境差异

**环境变量**：
- CLI 模式：使用系统环境变量
- Web 模式：使用 Web 服务器配置的环境变量

**输出方式**：
- CLI 模式：输出到终端
- Web 模式：输出到 HTTP 响应

**错误处理**：
- CLI 模式：错误直接显示在终端
- Web 模式：错误可能显示在浏览器或日志中

### 检测执行模式

**方法**：`php_sapi_name()`
**返回值**：
- CLI 模式：`'cli'`
- Web 模式：`'apache2handler'`、`'fpm-fcgi'` 等

## 总结

- CLI 模式适合脚本和命令行工具
- Web 模式适合 Web 应用
- 两种模式的执行环境不同
- 需要根据场景选择合适的执行方式
- 可以使用 `php_sapi_name()` 检测执行模式

## 相关资源

- **1.2.2 运行模式与验证**：详细了解不同运行模式
