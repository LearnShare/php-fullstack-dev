# 2.11.4 避免冲突和循环导入

## 概述

模块化开发中，需要避免名称冲突和循环导入问题。本节介绍如何避免函数名、类名、常量名冲突，循环导入的概念和问题，多种解决方案（重构、延迟加载、依赖注入、自动加载、事件驱动）。

**章节类型**：最佳实践章节

**主要内容**：
- 名称冲突的类型和原因
- 避免名称冲突的方法
- 循环导入的概念和问题
- 循环导入的解决方案
- 最佳实践

## 核心内容

### 名称冲突

**类型**：函数名、类名、常量名冲突
**原因**：多个模块定义相同名称
**解决**：使用命名空间、重命名、前缀

### 循环导入

**概念**：模块 A 导入模块 B，模块 B 导入模块 A
**问题**：导致重复定义、无限循环
**解决**：重构、延迟加载、依赖注入

## 基本用法

### 避免名称冲突示例

```php
<?php
declare(strict_types=1);

// 使用前缀
function math_add(int $a, int $b): int
{
    return $a + $b;
}

function string_add(string $a, string $b): string
{
    return $a . $b;
}
```

### 避免循环导入示例

```php
<?php
declare(strict_types=1);

// 延迟加载
function getDatabase()
{
    static $db = null;
    if ($db === null) {
        require 'Database.php';
        $db = new Database();
    }
    return $db;
}
```

## 使用场景

- **大型项目**：避免名称冲突
- **模块化开发**：避免循环导入
- **代码组织**：提高代码质量

## 注意事项

- **命名空间**：使用命名空间避免冲突（阶段三学习）
- **依赖管理**：注意模块间的依赖关系
- **重构**：必要时重构代码消除循环依赖

## 常见问题

### 问题 1：名称冲突
- **原因**：多个模块定义相同名称
- **解决**：使用命名空间或重命名

### 问题 2：循环导入
- **原因**：模块间相互依赖
- **解决**：重构代码，消除循环依赖

## 最佳实践

- 使用命名空间避免冲突
- 注意模块间的依赖关系
- 必要时重构代码
- 使用延迟加载避免循环导入
