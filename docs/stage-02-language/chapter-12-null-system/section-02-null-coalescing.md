# 2.12.2 空合并运算符

## 概述

空合并运算符（`??`）是 PHP 7.0 引入的特性，用于提供默认值。本节介绍空合并运算符的语法、用法、链式使用、空合并赋值运算符（`??=`）、与三元运算符的区别。

**章节类型**：语法性章节

**主要内容**：
- 空合并运算符（`??`）的语法和用法
- 链式使用
- 空合并赋值运算符（`??=`）
- 与三元运算符的区别
- 使用场景和最佳实践

## 特性

- **简洁性**：简化默认值赋值代码
- **安全性**：避免未定义变量错误
- **链式使用**：支持链式使用

## 语法/定义

### 空合并运算符

**语法**：`$a ?? $b`
**功能**：如果 `$a` 存在且不为 `null`，返回 `$a`，否则返回 `$b`
**要求**：PHP 7.0+

### 空合并赋值运算符

**语法**：`$a ??= $b`
**功能**：如果 `$a` 为 `null`，将 `$b` 赋值给 `$a`
**要求**：PHP 7.4+

## 基本用法

### 基础示例

```php
<?php
declare(strict_types=1);

$name = $userName ?? "Guest";
$value = $config['key'] ?? "default";
```

### 链式使用示例

```php
<?php
declare(strict_types=1);

$value = $a ?? $b ?? $c ?? "default";
```

### 空合并赋值示例

```php
<?php
declare(strict_types=1);

$name ??= "Guest";  // 如果 $name 为 null，赋值为 "Guest"
```

### 与三元运算符对比

```php
<?php
declare(strict_types=1);

// 空合并运算符
$name = $userName ?? "Guest";

// 三元运算符（等价但更复杂）
$name = isset($userName) ? $userName : "Guest";
```

## 使用场景

- **默认值**：为变量提供默认值
- **配置读取**：读取配置值，提供默认值
- **可选参数**：处理可选参数

## 注意事项

- **只检查 null**：只检查 `null`，不检查其他 falsy 值
- **优先级**：优先级较低，注意使用括号
- **链式使用**：支持链式使用

## 常见问题

### 问题 1：只检查 null
- **原因**：不理解只检查 `null` 的特性
- **解决**：理解空合并运算符的检查规则

### 问题 2：优先级问题
- **原因**：优先级较低
- **解决**：使用括号明确优先级

## 最佳实践

- 使用空合并运算符提供默认值
- 理解只检查 `null` 的特性
- 注意运算符优先级
- 使用链式使用简化代码
