# 2.5.2 显式转换

## 概述

显式转换是使用类型转换操作符主动进行的类型转换。本节介绍类型转换操作符的语法、各种类型的转换规则（int、float、bool、string、array、object）、转换示例及注意事项。

**章节类型**：语法性章节

**主要内容**：
- 类型转换操作符的语法
- 整数转换（`(int)`、`(integer)`）
- 浮点数转换（`(float)`、`(double)`、`(real)`）
- 布尔转换（`(bool)`、`(boolean)`）
- 字符串转换（`(string)`）
- 数组转换（`(array)`）
- 对象转换（`(object)`）
- 转换规则和注意事项

## 特性

- **显式控制**：明确指定转换类型
- **可读性**：代码意图更清晰
- **类型安全**：避免隐式转换的陷阱

## 语法/定义

### 类型转换操作符

**语法**：`(type) $value`
**支持类型**：`int`、`float`、`bool`、`string`、`array`、`object`

### 转换规则

**整数转换**：
- 浮点数：向下取整
- 字符串：从开头解析数字
- 布尔值：`true` → 1，`false` → 0

**浮点数转换**：
- 整数：直接转换
- 字符串：从开头解析数字
- 布尔值：`true` → 1.0，`false` → 0.0

**布尔转换**：
- 空值、0、空字符串、空数组 → `false`
- 其他 → `true`

**字符串转换**：
- 数字：转换为字符串表示
- 布尔值：`true` → "1"，`false` → ""
- 数组：转换为 "Array"
- 对象：尝试调用 `__toString()`

## 基本用法

### 整数转换示例

```php
<?php
declare(strict_types=1);

$float = 3.14;
$int = (int) $float;  // 3

$str = "123";
$int = (int) $str;  // 123
```

### 浮点数转换示例

```php
<?php
declare(strict_types=1);

$int = 42;
$float = (float) $int;  // 42.0

$str = "3.14";
$float = (float) $str;  // 3.14
```

### 布尔转换示例

```php
<?php
declare(strict_types=1);

$value = 0;
$bool = (bool) $value;  // false

$value = 1;
$bool = (bool) $value;  // true
```

### 字符串转换示例

```php
<?php
declare(strict_types=1);

$num = 42;
$str = (string) $num;  // "42"

$bool = true;
$str = (string) $bool;  // "1"
```

## 使用场景

- **数据验证**：将用户输入转换为期望类型
- **计算准备**：确保计算前类型正确
- **格式化输出**：将数据转换为字符串格式

## 注意事项

- **精度丢失**：浮点数转整数会丢失小数部分
- **字符串解析**：字符串转数字从开头解析
- **数组转换**：数组转字符串结果为 "Array"
- **对象转换**：对象转字符串需要 `__toString()` 方法

## 常见问题

### 问题 1：浮点数转整数精度丢失
- **原因**：向下取整规则
- **解决**：使用 `round()` 或 `ceil()` 函数

### 问题 2：数组转字符串
- **原因**：数组无法直接转换为有意义的字符串
- **解决**：使用 `json_encode()` 或 `serialize()`

## 最佳实践

- 使用显式转换提高代码可读性
- 理解各种类型的转换规则
- 注意精度丢失问题
- 使用合适的转换函数替代类型转换操作符
