# 2.5.4 比较运算符与函数

## 概述

比较是编程中的基本操作，PHP 提供了多种比较运算符和函数。本节介绍宽松比较（`==`）与严格比较（`===`）的区别、常见陷阱、比较函数（`strcmp()`、`strcasecmp()`、`bccomp()`、`version_compare()`）、太空船运算符（`<=>`）及最佳实践。

**章节类型**：语法性章节

**主要内容**：
- 宽松比较（`==`）的特点和陷阱
- 严格比较（`===`）的特点和优势
- 比较函数的使用
- 太空船运算符（`<=>`）的使用
- 比较最佳实践

## 特性

- **宽松比较**：会进行类型转换，可能导致意外结果
- **严格比较**：不进行类型转换，更安全
- **太空船运算符**：返回 -1、0、1，用于排序

## 语法/定义

### 宽松比较（==）

**语法**：`$a == $b`
**特点**：会进行类型转换
**陷阱**：可能导致意外结果

### 严格比较（===）

**语法**：`$a === $b`
**特点**：不进行类型转换
**优势**：更安全、更可预测

### 太空船运算符（<=>）

**语法**：`$a <=> $b`
**返回值**：
- `-1`：`$a < $b`
- `0`：`$a == $b`
- `1`：`$a > $b`

### 比较函数

**strcmp()**：字符串比较（区分大小写）
**strcasecmp()**：字符串比较（不区分大小写）
**bccomp()**：任意精度数字比较
**version_compare()**：版本号比较

## 基本用法

### 宽松比较示例

```php
<?php
declare(strict_types=1);

"123" == 123;   // true
"0" == false;   // true
"" == false;    // true
```

### 严格比较示例

```php
<?php
declare(strict_types=1);

"123" === 123;   // false
"0" === false;   // false
"" === false;    // false
```

### 太空船运算符示例

```php
<?php
declare(strict_types=1);

1 <=> 2;  // -1
2 <=> 2;  // 0
3 <=> 2;  // 1

// 用于排序
usort($array, fn($a, $b) => $a <=> $b);
```

### 比较函数示例

```php
<?php
declare(strict_types=1);

strcmp("Hello", "hello");  // 非零（区分大小写）
strcasecmp("Hello", "hello");  // 0（不区分大小写）
bccomp("1.23", "1.24", 2);  // -1
version_compare("1.2.3", "1.2.4");  // -1
```

## 使用场景

- **条件判断**：使用严格比较避免陷阱
- **排序**：使用太空船运算符简化排序代码
- **字符串比较**：使用比较函数处理特殊需求
- **版本比较**：使用 `version_compare()` 比较版本号

## 注意事项

- **始终使用严格比较**：避免隐式转换陷阱
- **理解比较规则**：了解各种类型的比较规则
- **性能考虑**：严格比较性能更好

## 常见问题

### 问题 1：宽松比较陷阱
- **原因**：类型转换导致意外结果
- **解决**：使用严格比较

### 问题 2：浮点数比较
- **原因**：浮点数精度问题
- **解决**：使用 `bccomp()` 或设置误差范围

## 最佳实践

- 始终使用严格比较（`===`、`!==`）
- 使用太空船运算符简化排序代码
- 使用合适的比较函数处理特殊需求
- 理解各种比较方法的区别和适用场景
