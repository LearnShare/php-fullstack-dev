# 2.4.2 复合类型

## 概述

复合类型是可以包含多个元素或方法的数据类型，包括数组类型、对象类型、可调用类型。本节详细介绍这三种复合类型的语法、特性、操作方法和使用场景。

**章节类型**：语法性章节

**主要内容**：
- 数组类型（`array`）的创建、操作、高阶函数、排序
- 对象类型（`object`）的创建、类型检测、克隆
- 可调用类型（`callable`）的各种形式及使用场景
- 各类型的常用操作
- 类型检测方法

## 特性

- **数组类型**：有序映射，可同时包含数字键与字符串键
- **对象类型**：类的实例，包含属性和方法
- **可调用类型**：函数、方法、闭包等可调用的值

## 语法/定义

### 数组类型

**创建方式**：
- 短数组语法：`[]`
- 长数组语法：`array()`

**类型检测**：`is_array($value)`
**特点**：有序映射，键可以是整数或字符串

### 对象类型

**创建方式**：通过 `new` 关键字创建类的实例
**类型检测**：`is_object($value)`、`instanceof`
**特点**：包含属性和方法

### 可调用类型

**形式**：
- 函数名：`'function_name'`
- 方法：`[$object, 'method']` 或 `[ClassName::class, 'method']`
- 闭包：`function() { ... }`
- 实现了 `__invoke()` 的对象

**类型检测**：`is_callable($value)`

## 基本用法

### 数组示例

```php
<?php
declare(strict_types=1);

$arr = [1, 2, 3];
$assoc = ['name' => 'John', 'age' => 25];
```

### 对象示例

```php
<?php
declare(strict_types=1);

class User
{
    public string $name;
    public int $age;
}

$user = new User();
$user->name = "John";
$user->age = 25;
```

### 可调用类型示例

```php
<?php
declare(strict_types=1);

$func = 'strlen';
$result = $func("Hello");

$closure = function($x) { return $x * 2; };
$result = $closure(5);
```

## 使用场景

- **数组**：数据集合、配置、映射
- **对象**：面向对象编程、数据封装
- **可调用类型**：回调函数、事件处理

## 注意事项

- **数组键类型**：键可以是整数或字符串
- **对象克隆**：使用 `clone` 关键字克隆对象
- **可调用类型**：确保可调用，使用 `is_callable()` 检查

## 常见问题

### 问题 1：数组键类型混淆
- **原因**：不理解数组键的类型
- **解决**：理解数组是有序映射的本质

### 问题 2：对象引用问题
- **原因**：对象赋值是引用赋值
- **解决**：使用 `clone` 创建副本

## 最佳实践

- 理解数组是有序映射
- 使用类型声明提高代码质量
- 检查可调用类型是否可调用
- 理解对象引用和克隆
