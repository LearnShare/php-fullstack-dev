# 2.3.2 引用与可变变量

## 概述

引用和可变变量是 PHP 的高级特性。本节介绍引用传递、引用赋值、可变变量、可变函数等概念，帮助理解 PHP 变量的引用机制和动态特性。

**章节类型**：语法性章节

**主要内容**：
- 引用的概念和用法
- 引用传递和引用赋值
- 可变变量的使用
- 可变函数的使用
- 引用和可变变量的应用场景
- 注意事项和陷阱

## 特性

- **引用**：变量别名，多个变量指向同一个值
- **可变变量**：变量名可以动态生成
- **可变函数**：函数名可以动态生成

## 语法/定义

### 引用赋值

**语法**：`$var1 = &$var2;`
**作用**：`$var1` 和 `$var2` 指向同一个值
**示例**：`$a = &$b;`

### 引用传递

**语法**：`function func(&$param)`
**作用**：参数按引用传递
**示例**：`function swap(&$a, &$b)`

### 可变变量

**语法**：`$$variable_name`
**作用**：变量名动态生成
**示例**：`$name = "user"; $$name = "John";` 等同于 `$user = "John";`

### 可变函数

**语法**：`$function_name()`
**作用**：函数名动态生成
**示例**：`$func = "strlen"; $result = $func("Hello");`

## 基本用法

### 引用示例

```php
<?php
declare(strict_types=1);

$a = 10;
$b = &$a;  // $b 是 $a 的引用
$b = 20;   // 修改 $b 也会修改 $a
echo $a;   // 输出 20
```

### 可变变量示例

```php
<?php
declare(strict_types=1);

$name = "user";
$$name = "John";  // 等同于 $user = "John"
echo $user;       // 输出 "John"
```

### 可变函数示例

```php
<?php
declare(strict_types=1);

$func = "strlen";
$result = $func("Hello");  // 等同于 strlen("Hello")
echo $result;  // 输出 5
```

## 使用场景

- **引用**：需要修改函数参数、避免大数组复制
- **可变变量**：动态生成变量名（较少使用）
- **可变函数**：根据条件调用不同函数

## 注意事项

- **引用陷阱**：引用可能导致意外的副作用
- **性能考虑**：引用可以避免大数组复制
- **可读性**：过度使用可变变量和可变函数会降低可读性

## 常见问题

### 问题 1：引用导致意外修改
- **原因**：引用传递导致原变量被修改
- **解决**：谨慎使用引用，明确标注

### 问题 2：可变变量混淆
- **原因**：可变变量使代码难以理解
- **解决**：避免过度使用，使用数组替代

## 最佳实践

- 谨慎使用引用
- 避免过度使用可变变量
- 使用数组替代可变变量
- 明确标注引用参数
