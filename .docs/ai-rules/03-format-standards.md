# 格式规范

## 概述

本文档定义了所有文档的格式规范，包括 Markdown 格式和代码格式。

---

## Markdown 格式规范

### 标题与空行

**必须遵守**：

- 标题（`#`、`##`、`###` 等）前后必须各留一空行
- 代码块前后必须各留一空行
- 段落之间必须留一空行
- 列表与上一段之间必须留空行

**示例**：

```markdown
这是段落内容。

## 标题

这是标题后的内容。

```php
$code = 'example';
```

这是代码块后的内容。
```

### 表格对齐（重要）

**核心要求**：表格必须在 Markdown 源文件中按 `|` 进行列对齐，以方便直接阅读原始文本。

**对齐规则**：

- 表格列宽必须在源文件中对齐，使用空格填充，确保所有行的 `|` 在同一列位置对齐
- 必须使用对齐标记：
  - 文本列左对齐：`|:---|`
  - 数值列右对齐：`|---:|`
  - 可选居中：`|:---:|`
- **宽度比例**：**9 个中文字符 ≈ 15 个英文字符**（用于计算列宽）
- 分隔线必须与列宽对齐

**宽度计算方法**：

- 中文字符按 9 个字符宽度计算
- 英文字符、数字、符号按 1 个字符宽度计算
- 混合内容：中文字符数 × 9 + 英文字符数 = 总宽度

**正确示例**：

```markdown
| 特性                 | Laravel | Symfony |
|:---------------------|:--------|:--------|
| **学习曲线**         | 简单    | 复杂    |
| **性能**             | 良好    | 优秀    |
```

### 代码块格式

**必须遵守**：

- 使用标准 Markdown 代码块格式：```` ```php ````
- **禁止使用** CODE REFERENCES 格式（如 ````startLine:endLine:filepath）
- 代码块前后各留一空行
- **语言标识必须使用简写**：`php`、`bash`（不是 `shell`）、`json`、`md`、`sql`、`js`（不是 `javascript`）、`ts`（不是 `typescript`）

**示例**：

```markdown
## 代码示例

```php
<?php
declare(strict_types=1);

echo "Hello, World!";
```
```

### 列表格式

**规则**：

- 无序列表使用 `- `（短横线 + 空格）
- 有序列表使用 `1. `（数字 + 点 + 空格）
- 列表与上一段之间留空行
- 嵌套列表使用缩进（2 个空格或 4 个空格，保持一致）

### 行宽控制

**规则**：

- 避免过长行（建议 <100 字符）
- 必要时采用列表、子标题等替代表达
- 段落不宜过长（建议 <6 行）

---

## 代码格式规范

### PHP 代码规范（强制）

**PSR-1 基础编码标准**：

- 纯 PHP 文件必须使用 `<?php` 标签
- **纯 PHP 文件不得使用结束标签 `?>`**（PSR-1 强制要求）
- 必须使用 UTF-8 编码（无 BOM）

**PSR-12 扩展编码风格指南**：

- 使用 4 个空格缩进（不使用 Tab）
- 行尾不能有尾随空格
- 文件必须以空行结尾
- `declare(strict_types=1);` 必须在文件第一行（`<?php` 之后）
- 类和方法的左花括号必须在下一行
- 控制结构的左花括号必须在同一行

**正确示例**：

```php
<?php
declare(strict_types=1);

namespace App\Services;

use App\Models\User;

class UserService
{
    public function getUser(int $id): ?User
    {
        if ($id <= 0) {
            return null;
        }

        return User::find($id);
    }
}
```

### 类型声明

**必须遵守**：

- 所有函数必须包含类型声明（参数类型、返回类型）
- 使用 PHP 8.2+ 语法特性
- 优先使用现代特性（构造器属性提升、枚举、只读属性等）

### 代码完整性

**要求**：

- 代码示例必须完整、可运行
- 必须包含必要的导入语句（如 `declare(strict_types=1);`）
- 不能是伪代码或片段（除非明确标注为片段）

---

## 格式检查清单

在编写或审查文档时，必须确认：

- [ ] 所有标题前后都有空行
- [ ] 所有代码块前后都有空行
- [ ] 所有段落之间都有空行
- [ ] 表格在源文件中按 `|` 对齐列宽
- [ ] 表格使用对齐标记（`|:---|` 等）
- [ ] 表格宽度比例正确（9 中文 ≈ 15 英文）
- [ ] 代码块使用标准格式（```php），无 CODE REFERENCES
- [ ] 语言标识使用简写（`php`、`bash` 等）
- [ ] 行宽控制良好（<100 字符）
- [ ] PHP 代码符合 PSR-1 和 PSR-12 规范
- [ ] 纯 PHP 文件未使用结束标签 `?>`
- [ ] 所有函数包含类型声明

---

**最后更新**：2025-12-31
