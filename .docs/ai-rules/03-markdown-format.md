# Markdown 格式规范

## 概述

本文档定义了所有 Markdown 文档的格式规范。**严格遵守本规范，确保文档源文件具有良好的可读性和一致性。**

## 标题与空行

### 基本规则

**必须遵守**：
- 标题（`#`、`##`、`###` 等）前后必须各留一空行
- 代码块前后必须各留一空行
- 段落之间必须留一空行
- 列表与上一段之间必须留空行
- 列表项内如含多段文本，段间亦需空行

### 标题空行的各种场景

#### 场景 1：标题前有段落

```markdown
这是段落内容。

## 标题

这是标题后的内容。
```

#### 场景 2：标题后跟列表

```markdown
## 标题

- 列表项 1
- 列表项 2
```

#### 场景 3：标题后跟代码块

```markdown
## 标题

```php
$code = 'example';
```

这是代码块后的内容。
```

#### 场景 4：连续标题

```markdown
## 一级标题

### 二级标题

这是内容。
```

#### 场景 5：标题在文档开头

```markdown
# 文档标题

这是文档的第一段内容。
```

**错误示例**（缺少空行）：

```markdown
这是段落内容。
## 标题
这是标题后的内容。
```

**正确示例**：

```markdown
这是段落内容。

## 标题

这是标题后的内容。
```

### 段落与代码块

**规则**：
- 段落之间必须留一空行
- 代码块前后必须各留一空行
- 严禁连续出现两行空行

**示例**：

```markdown
这是第一段。

这是第二段。

```php
$code = 'example';
```

这是代码块后的段落。
```

## 表格对齐（重要）

### 核心要求

**表格必须在 Markdown 源文件中按 `|` 进行列对齐，以方便直接阅读原始文本。**

### 对齐规则

**必须遵守**：
- 表格列宽必须在源文件中对齐，使用空格填充，确保所有行的 `|` 在同一列位置对齐
- 必须使用对齐标记：
  - 文本列左对齐：`|:---|`
  - 数值列右对齐：`|---:|`
  - 可选居中：`|:---:|`
- 宽度比例：**9 个中文字符 ≈ 15 个英文字符**（用于计算列宽）
- 分隔线必须与列宽对齐
- 行尾无多余空格

### 宽度计算方法

**中英文混合处理**：
- 计算列宽时，中文字符按 9 个字符宽度计算
- 英文字符、数字、符号按 1 个字符宽度计算
- 混合内容：中文字符数 × 9 + 英文字符数 = 总宽度

**示例计算**：
- "特性"（2 个中文）= 2 × 9 = 18 个字符宽度
- "Laravel"（7 个英文）= 7 个字符宽度
- "学习曲线"（4 个中文）= 4 × 9 = 36 个字符宽度

### 表格对齐示例

**错误示例**（未对齐）：

```markdown
| 特性 | Laravel | Symfony |
|------|---------|---------|
| 学习 | 简单   | 复杂   |
```

**正确示例**（已对齐）：

```markdown
| 特性                 | Laravel | Symfony |
|:---------------------|:--------|:--------|
| **学习曲线**         | 简单    | 复杂    |
| **性能**             | 良好    | 优秀    |
```

**对齐说明**：
- 第一列"特性"：18 字符宽度，内容"学习曲线"36 字符，需要对齐到至少 36 字符位置
- 第二列"Laravel"：7 字符宽度，内容"简单"18 字符，需要对齐到至少 18 字符位置
- 第三列"Symfony"：7 字符宽度，内容"复杂"18 字符，需要对齐到至少 18 字符位置

### 多行单元格处理

**规则**：
- 多行单元格内容，每行都需要对齐
- 使用 `<br>` 或保持单元格内格式一致

**示例**：

```markdown
| 功能                 | 说明                                 |
|:---------------------|:-------------------------------------|
| **多行说明**         | 第一行内容<br>第二行内容             |
| **单行说明**         | 单行内容                             |
```

### 表格对齐检查

**验证方法**：
- 在文本编辑器中查看源文件
- 确保所有 `|` 符号垂直对齐
- 使用等宽字体查看效果最佳

## 代码块格式

### 基本规则

**必须遵守**：
- 使用标准 Markdown 代码块格式：```` ```php ````
- **禁止使用** CODE REFERENCES 格式（如 ````startLine:endLine:filepath）
- 代码块前后各留一空行
- **语言标识必须使用简写**：`php`、`bash`（不是 `shell`）、`json`、`md`、`sql` 等
- 代码内容保持原样，不额外插入无关注释或空格

### 语言标识列表

**常用语言标识**：
- `php` - PHP 代码
- `bash` - Bash 脚本（不是 `shell`）
- `json` - JSON 数据
- `md` - Markdown 文档
- `sql` - SQL 语句
- `yaml` - YAML 配置
- `xml` - XML 文档
- `html` - HTML 代码
- `css` - CSS 样式
- `js` - JavaScript 代码（**必须使用简写 `js`，不使用 `javascript`**）
- `ts` - TypeScript 代码（**必须使用简写 `ts`，不使用 `typescript`**）

### 代码块标注（推荐）

**格式**：
- 在代码块内使用注释标注文件路径、行号、上下文（如适用）
- 使用 `// 文件:` 标注文件路径
- 使用 `// 行号:` 标注行号范围
- 使用 `// 功能:` 标注功能说明

**示例**：

```php
// 文件: src/Utils/Helper.php
// 行号: 10-15
// 功能: 格式化日期

function formatDate(DateTime $date): string
{
    return $date->format('Y-m-d');
}
```

### 代码块前后空行

**规则**：
- 代码块前必须有一空行
- 代码块后必须有一空行
- 代码块与标题之间必须有一空行

**示例**：

```markdown
## 代码示例

```php
$code = 'example';
```

这是代码块后的内容。
```

### 行内代码

**规则**：
- 使用反引号包裹：`` `inline` ``
- 避免与周围标点粘连
- 行内代码前后不需要空格（除非语法要求）

**示例**：
- 正确：使用 `strlen()` 函数
- 错误：使用`strlen()`函数（与标点粘连）

## 列表格式

### 基本规则

**必须遵守**：
- 无序列表使用 `- `（短横线 + 空格）
- 有序列表使用 `1. `（数字 + 点 + 空格）
- 列表条目简洁；多级内容用子列表
- 列表与上一段之间留空行

### 嵌套列表

**规则**：
- 嵌套列表使用缩进（2 个空格或 4 个空格，保持一致）
- 嵌套列表前后不需要额外空行（除非列表项内包含多段文本）

**示例**：

```markdown
- 第一级
  - 第二级
    - 第三级
- 第一级
```

### 列表内代码块

**规则**：
- 列表项内的代码块需要额外缩进
- 代码块前后需要空行

**示例**：

```markdown
- 列表项 1

  ```php
  $code = 'example';
  ```

  代码块后的说明。

- 列表项 2
```

### 列表内表格

**规则**：
- 列表项内的表格需要额外缩进
- 表格前后需要空行

**示例**：

```markdown
- 列表项 1

  | 列1 | 列2 |
  |:----|:----|
  | 值1 | 值2 |

  表格后的说明。

- 列表项 2
```

### 列表项内多段文本

**规则**：
- 列表项内如含多段文本，段间需空行
- 段落需要缩进

**示例**：

```markdown
- 列表项 1

  这是第一段。

  这是第二段。

- 列表项 2
```

## 行宽控制

### 基本规则

**必须遵守**：
- 避免过长行（建议 <100 字符）
- 必要时采用列表、子标题等替代表达
- 段落不宜过长（建议 <6 行）
- 超长信息拆成多行或子项

### 具体限制

**行宽建议**：
- 普通文本行：<100 字符
- 代码注释行：<80 字符（如适用）
- 表格单元格：根据内容调整，但避免过长

### 超长内容处理

**方法**：
- 使用列表拆分长段落
- 使用子标题组织内容
- 使用代码块展示长代码
- 使用表格展示结构化数据

**示例**：

```markdown
## 功能说明

### 功能 1

功能 1 的详细说明。

### 功能 2

功能 2 的详细说明。
```

## 其他格式规则

### 强调与加粗

**规则**：
- 使用 `**文本**` 表示加粗
- 使用 `*文本*` 表示斜体（谨慎使用）
- 避免过度使用强调

### 链接格式

**规则**：
- 使用 `[链接文本](链接地址)` 格式
- 相对路径使用相对于当前文件的路径
- 绝对路径使用项目根目录的相对路径

**示例**：
- `[函数文档格式标准](07-function-documentation.md)`
- `[基础规则](01-basic-rules.md)`

### 水平分割线

**规则**：
- 使用 `---`（三个短横线）作为水平分割线
- 分割线前后各留一空行

**示例**：

```markdown
这是上一部分内容。

---

这是下一部分内容。
```

## 格式检查清单

在编写或审查 Markdown 文档时，必须确认：

- [ ] 所有标题前后都有空行
- [ ] 所有代码块前后都有空行
- [ ] 所有段落之间都有空行
- [ ] 表格在源文件中按 `|` 对齐列宽
- [ ] 表格使用对齐标记（`|:---|` 等）
- [ ] 表格宽度比例正确（9 中文 ≈ 15 英文）
- [ ] 代码块使用标准格式（```php），无 CODE REFERENCES
- [ ] 语言标识使用简写（`php`、`bash` 等）
- [ ] 行宽控制良好（<100 字符）
- [ ] 列表格式正确
- [ ] 嵌套列表缩进一致
- [ ] 列表内代码块和表格格式正确

---

**最后更新**：2025-12-22
